# Officially Human Art — Data Protection Risk Assessment

**Date:** 30 January 2026
**Jurisdiction:** United Kingdom (UK GDPR / Data Protection Act 2018)
**Service:** Officially Human Art — AI-free art certification platform
**Status:** Pre-production prototype

---

## 1. Data Controller

The operator of Officially Human Art is the data controller for all personal data processed through the platform. Contact details should be published in the privacy notice and legal page before production launch.

---

## 2. Data Inventory

### 2.1 Personal Data Collected at Registration

| Data Element | Source | Storage Location | Required |
|---|---|---|---|
| Full name | User input (registration form) | `db.json` → `artists[id].name` | Yes |
| Email address | User input (registration form) | `db.json` → `artists[id].email` | Yes |
| Password | User input (registration form) | `db.json` → `artists[id].passwordHash` (bcrypt) | Yes |
| Portfolio URL | User input (registration form) | `db.json` → `artists[id].portfolio` | No |
| Bio | User input (registration form) | `db.json` → `artists[id].bio` | No |
| Location | User input (registration form) | `db.json` → `artists[id].location` | No |

### 2.2 Personal Data Generated by the System

| Data Element | Source | Storage Location | Purpose |
|---|---|---|---|
| Artist ID (UUID) | Auto-generated | `db.json` → `artists[id].id` | Internal identifier |
| URL slug | Derived from name | `db.json` → `artists[id].slug` | Public profile URL |
| Account creation date | Auto-generated | `db.json` → `artists[id].createdAt` | Record keeping |
| Stripe customer ID | Stripe API | `db.json` → `artists[id].stripeCustomerId` | Payment processing |
| Stripe subscription ID | Stripe API | `db.json` → `artists[id].stripeSubscriptionId` | Subscription management |
| Plan status & expiry | System/Stripe | `db.json` → `artists[id].planStatus`, `planExpiresAt` | Access control |
| Password reset token | Auto-generated (UUID) | `db.json` → `artists[id].resetToken` | Password recovery |
| Reset token expiry | Auto-generated | `db.json` → `artists[id].resetTokenExpires` | Token validity |

### 2.3 Artwork & Certificate Data

| Data Element | Source | Storage Location |
|---|---|---|
| Artwork title, description, medium, creation date | User input (submission form) | `db.json` → `certificates[id].*` |
| Process notes | User input (submission form) | `db.json` → `certificates[id].processNotes` |
| Human creation declaration | User checkbox | `db.json` → implicit (submission rejected without it) |
| Artwork image file | User upload | `uploads/` directory on disk |
| Evidence/WIP files (up to 10) | User upload | `uploads/` directory on disk |
| Evidence visibility flags | User selection per file | `db.json` → `certificates[id].evidenceFiles[].public` |
| Certificate ID, tier, strength | Auto-generated | `db.json` → `certificates[id].*` |
| Certificate history (edits, reports) | System-generated | `db.json` → `certificates[id].history[]` |

### 2.4 Report/Dispute Data

| Data Element | Source | Storage Location |
|---|---|---|
| Report reason text | Reporter input | `db.json` → `reports[id].reason` |
| Reporter email (optional) | Reporter input | `db.json` → `reports[id].reporterEmail` |
| Report status & date | System-generated | `db.json` → `reports[id].status`, `createdAt` |

### 2.5 Technical/Derived Data

| Data Element | Source | Purpose |
|---|---|---|
| IP address | HTTP request | Rate limiting (registration, login, password reset) |
| Request metadata | HTTP headers | Standard Express.js request handling |

**Note:** IP addresses are used transiently for rate limiting (in-memory store) and are not persisted to disk.

---

## 3. Lawful Basis for Processing

| Data Category | Lawful Basis (Art. 6 UK GDPR) | Justification |
|---|---|---|
| Name, email, password | **Contractual necessity** (Art. 6(1)(b)) | Required to create and manage user account, deliver certification service |
| Portfolio, bio, location | **Legitimate interest** (Art. 6(1)(f)) | Enhances public profile; user voluntarily provides; can leave blank |
| Artwork details & files | **Contractual necessity** (Art. 6(1)(b)) | Core service delivery — certification of human-made artwork |
| Stripe IDs & payment data | **Contractual necessity** (Art. 6(1)(b)) | Required to process Creator tier subscription payments |
| Password reset tokens | **Contractual necessity** (Art. 6(1)(b)) | Account recovery function integral to service |
| Reporter email | **Legitimate interest** (Art. 6(1)(f)) | Optional; allows follow-up on disputes |
| IP addresses (transient) | **Legitimate interest** (Art. 6(1)(f)) | Security — preventing brute force and abuse |
| Certificate history | **Legitimate interest** (Art. 6(1)(f)) | Transparency and integrity of certification records |

---

## 4. Data Storage

### 4.1 Database

- **Format:** Single JSON file (`data/db.json`)
- **Location:** Local disk (development) or Railway persistent volume (`/app/persist/data/db.json` in production)
- **Encryption at rest:** None — plaintext JSON
- **Access control:** File system permissions only; no database-level authentication
- **Concurrency:** Synchronous `fs.readFileSync`/`fs.writeFileSync` — no locking mechanism

### 4.2 Uploaded Files

- **Location:** `uploads/` directory (local) or `/app/persist/uploads/` (Railway)
- **Naming:** Timestamped original filename (`Date.now() + '-' + file.originalname`)
- **Size limit:** 20 MB per file (multer configuration)
- **Type validation:** None server-side (multer accepts any file type)
- **Access control:** Served as static files via Express — all files accessible by direct URL

### 4.3 Hosting Environment

- **Platform:** Railway (production), localhost (development)
- **Persistent storage:** Railway volume mount at `/app/persist`
- **Backups:** None configured
- **Region:** Railway default (likely US/EU — to be confirmed)

---

## 5. Data Sharing

### 5.1 Publicly Accessible Data

The following data is intentionally public by design:

| Data | Access Method |
|---|---|
| Artist name, bio, location, portfolio URL, member-since date | Public profile page (`/profile.html?slug=...`) |
| Certificate details (title, description, medium, creation date, tier, process notes) | Verification page (`/verify.html?code=...`) and browse page |
| Artwork images | Direct URL (`/uploads/filename`) and embedded in public pages |
| Public evidence files | Verification page (filtered by `public: true` flag) |
| Certificate ID and QR code | Embeddable badges and widgets |
| Aggregate stats (artist count, certificate count, tier breakdown) | `/api/stats` endpoint |

### 5.2 Third-Party Data Sharing

| Third Party | Data Shared | Purpose | Data Processing Location |
|---|---|---|---|
| **Stripe** | Email, name, artist ID (as metadata) | Payment processing for Creator tier | Stripe infrastructure (US/EU) |
| **SMTP provider / Resend** (planned) | Recipient email address, certificate details, password reset links | Transactional email delivery | Provider infrastructure |
| **Google Fonts** | IP address, browser user-agent (implicit via font request) | Font loading (Cormorant Garamond, DM Sans) | Google CDN |

### 5.3 Data Not Shared

- Passwords / password hashes — never sent to third parties
- Private evidence files — not exposed via verification API (only `public: true` files returned)
- Stripe customer/subscription IDs — stripped by `safeArtist()` before client responses
- IP addresses — used transiently, not stored or forwarded

---

## 6. Security Measures in Place

### 6.1 Password Security

| Measure | Implementation | Reference |
|---|---|---|
| bcrypt hashing | `bcrypt.hash(password, 10)` — 10 salt rounds | `server.js:328`, `server.js:1046` |
| Password stripping | `safeArtist()` removes `passwordHash`, `stripeCustomerId`, `stripeSubscriptionId` from API responses | `server.js:301-304` |
| Minimum length | 6 characters enforced on registration and reset | `server.js:315`, `server.js:1033` |

### 6.2 Rate Limiting

| Endpoint | Key | Limit | Window |
|---|---|---|---|
| Registration | `register:` + IP | 5 attempts | 1 hour |
| Login | `login:` + IP | 10 attempts | 15 minutes |
| Password reset request | `forgot:` + IP | 3 attempts | 1 hour |

Implementation: In-memory sliding window (`server.js:288-296`).

### 6.3 XSS Prevention

| Measure | Implementation | Reference |
|---|---|---|
| `escHtml()` | HTML entity encoding in all client-side pages | `verify.html:1130`, `browse.html:401`, `profile.html:673`, `register.html:1501` |
| `escAttr()` | Attribute encoding for OG meta tags in server-side HTML injection | `server.js:93` |

### 6.4 Other Security Measures

| Measure | Detail |
|---|---|
| Email enumeration prevention | Forgot-password always returns success regardless of email existence (`server.js:981-983`) |
| Reset token expiry | Tokens valid for 1 hour; deleted after use (`server.js:988`, `server.js:1047-1048`) |
| Upload size limit | 20 MB per file via multer (`server.js:152`) |
| Artist ID ownership check | Certificate delete/edit require matching `artistId` (`server.js:794`, `server.js:832`) |
| Password-confirmed deletion | Account deletion requires password verification (`server.js:1083-1087`) |

---

## 7. Security Gaps & Risk Ratings

### 7.1 Critical Risks

| # | Risk | Description | Impact |
|---|---|---|---|
| C1 | **No HTTPS enforcement** | Server listens on HTTP. No redirect to HTTPS; no HSTS header. Passwords, tokens, and personal data transmitted in cleartext if HTTPS not enforced at proxy/platform level. | Credential interception, session hijacking |
| C2 | **Plaintext database** | `db.json` stores all personal data including bcrypt hashes, Stripe IDs, reset tokens as unencrypted JSON on disk. Anyone with file system access can read all data. | Full data breach if server compromised |
| C3 | **No API authentication** | All API endpoints rely on client-supplied `artistId` for authorisation. No session tokens, JWTs, or cookies. Any party knowing an artist's UUID can act as that artist. | Unauthorised certificate deletion/editing, account impersonation |
| C4 | **Private evidence files accessible via direct URL** | All uploaded files served as static assets at `/uploads/filename`. Evidence files marked `public: false` are only hidden from the verification API response but remain accessible if the filename is known or guessed. | Exposure of private work-in-progress materials |

### 7.2 High Risks

| # | Risk | Description | Impact |
|---|---|---|---|
| H1 | **No CSRF protection** | No CSRF tokens on any forms or API endpoints. No SameSite cookie attributes (no cookies used). POST/PUT/DELETE endpoints unprotected. | Cross-site request forgery — attacker could delete certificates, submit artwork, or delete accounts via malicious pages |
| H2 | **No security headers** | Missing `Content-Security-Policy`, `X-Frame-Options`, `X-Content-Type-Options`, `Strict-Transport-Security`, `Referrer-Policy`. | Clickjacking, MIME sniffing, data leakage via referrer |
| H3 | **No server-side file type validation** | Multer accepts any file type/extension. No magic byte or MIME type verification. | Malicious file upload (HTML files served as pages, potential stored XSS, executable uploads) |
| H4 | **Client-side session only** | Artist identity stored in browser memory/localStorage. No server-side session management. Logout is purely client-side. | No ability to invalidate sessions; no session timeout; no forced logout on password change |
| H5 | **In-memory rate limiting resets on restart** | Rate limit state stored in a JavaScript object. Server restart clears all rate limiting data. | Brute-force protection bypassed during deployments or crashes |
| H6 | **No audit logging** | No logging of authentication events, data changes, file access, or administrative actions. `console.error` only for Stripe and email failures. | Inability to detect or investigate breaches; non-compliance with accountability principle |

### 7.3 Medium Risks

| # | Risk | Description | Impact |
|---|---|---|---|
| M1 | **Predictable file naming** | Upload filenames use `Date.now() + '-' + originalname`. Timestamps are sequential and original filenames visible. | Enumeration of uploaded files; privacy leakage via original filenames |
| M2 | **No password complexity rules** | Only minimum length of 6 characters enforced. No checks for common passwords, repeated characters, or breached password lists. | Weak passwords susceptible to dictionary attacks |
| M3 | **Backward-compatible passwordless login** | Accounts created before password auth can log in without a password (`server.js:367-369`). | Legacy accounts have zero authentication |
| M4 | **Stripe error messages exposed** | Stripe subscription creation errors include `err.message` in response (`server.js:743`). | Internal error details leak to client |
| M5 | **No data processing agreements documented** | No evidence of DPAs with Stripe, SMTP provider, or Railway. | Non-compliance with Art. 28 UK GDPR (processor obligations) |
| M6 | **Google Fonts external dependency** | All pages load fonts from `fonts.googleapis.com`. Google receives visitor IP addresses and user-agent strings. | Third-party tracking; potential GDPR issue (cf. German court rulings on Google Fonts) |
| M7 | **File deletion race condition** | Certificate deletion uses `fs.unlinkSync` without locking. Concurrent requests could cause errors. | Data corruption or orphaned files |

### 7.4 Low Risks

| # | Risk | Description | Impact |
|---|---|---|---|
| L1 | **Original filename preserved in upload path** | Filenames may contain PII or sensitive information from the uploader's device. | Minor privacy leakage |
| L2 | **No input length limits on text fields** | Title, description, processNotes, bio have no maximum length validation. | Potential for oversized DB entries; minor DoS vector |
| L3 | **Certificate ID guessable format** | `OH-YYYY-XXXXXX` with 6 alphanumeric characters (~2.2 billion combinations). Not sequentially enumerable but limited space. | Low-probability certificate enumeration |

---

## 8. Data Retention

| Data Type | Retention Period | Mechanism |
|---|---|---|
| Artist accounts | Indefinite — until user deletes account | No automated expiry |
| Certificates & artwork | Indefinite — until user deletes certificate or account | No automated expiry |
| Uploaded files (images, evidence) | Indefinite — until associated certificate or account deleted | Deleted with certificate via `fs.unlinkSync` |
| Password reset tokens | 1 hour | Token expires; deleted on use (`server.js:1047-1048`) |
| Rate limiting data | In-memory; cleared on server restart | JavaScript object; no persistence |
| Reports/disputes | Indefinite | No expiry or deletion mechanism |
| Stripe data | Per Stripe's retention policies | Managed by Stripe |

**Gap:** No defined data retention policy. No automated deletion of inactive accounts. No mechanism to expire or archive old certificates.

---

## 9. Data Deletion & Erasure

### 9.1 Account Deletion Flow

The platform provides a password-confirmed account deletion endpoint (`DELETE /api/artist/:artistId`):

1. User provides password for verification (`server.js:1069-1087`)
2. Active Stripe subscription cancelled (`server.js:1091-1097`)
3. All certificates deleted from `db.json` (`server.js:1100-1114`)
4. All associated artwork images and evidence files deleted from disk (`server.js:1102-1112`)
5. All reports linked to the artist's certificates deleted (`server.js:1117-1121`)
6. Artist record deleted from `db.json` (`server.js:1124`)

### 9.2 Certificate Deletion Flow

Individual certificates can be deleted via `DELETE /api/artwork/:certificateId`:

1. Ownership verified via `artistId` (`server.js:794`)
2. Artwork image deleted from disk (`server.js:799-801`)
3. Evidence files deleted from disk (`server.js:803-808`)
4. Certificate record deleted from `db.json` (`server.js:810`)

### 9.3 Gaps in Erasure

| Gap | Detail |
|---|---|
| No bulk export (data portability) | No endpoint to download all personal data (Art. 20 UK GDPR) |
| No formal DSAR process | No documented procedure for handling data subject access requests |
| Stripe data persists | Customer and payment data retained by Stripe per their policies even after local deletion |
| Email provider logs | Transactional emails may be retained by the SMTP provider |
| No backup restoration consideration | If backups were implemented, deleted data could persist in backup copies |
| Reports from deleted accounts | Reports submitted *about* other users' certificates are not deleted when the reporter's identity is unknown (email optional) |

---

## 10. Rights of Data Subjects

| Right (UK GDPR) | Current Support | Gap |
|---|---|---|
| **Right of access** (Art. 15) | Partial — users can view their data via login/dashboard | No formal DSAR process; no data export feature |
| **Right to rectification** (Art. 16) | Partial — certificate title, description, process notes editable | Profile fields (name, email, bio, location, portfolio) not editable via the platform |
| **Right to erasure** (Art. 17) | Supported — full account deletion with password confirmation | No granular deletion (e.g. delete bio but keep account); see erasure gaps above |
| **Right to restrict processing** (Art. 18) | Not supported | No mechanism to restrict processing while retaining data |
| **Right to data portability** (Art. 20) | Not supported | No data export endpoint |
| **Right to object** (Art. 21) | Not applicable | No marketing or profiling activities |
| **Rights related to automated decision-making** (Art. 22) | Not applicable | No automated decisions with legal effects (tier calculation is informational only) |

---

## 11. International Data Transfers

| Transfer | Destination | Safeguard |
|---|---|---|
| Stripe payment processing | US (Stripe, Inc.) | UK-US Data Bridge; Stripe's SCCs |
| Google Fonts requests | US (Google LLC) | Implicit transfer via browser request; no contractual safeguard in place |
| SMTP email delivery | Depends on provider (Resend: US) | To be confirmed; DPA and transfer mechanism required |
| Railway hosting | US (Railway Corp) | Platform hosting; DPA and transfer mechanism required |

---

## 12. Recommended Mitigations

### Critical — Implement Before Production

| # | Mitigation | Addresses |
|---|---|---|
| 1 | **Implement HTTPS enforcement** — configure Railway for HTTPS-only; add HSTS header; redirect HTTP to HTTPS | C1 |
| 2 | **Encrypt database at rest** — use encrypted volume or switch to a proper database with encryption (e.g. PostgreSQL with TDE, or SQLite with SQLCipher) | C2 |
| 3 | **Implement server-side session management** — use signed HTTP-only cookies or JWT tokens; validate session on every authenticated request; invalidate on logout and password change | C3, H4 |
| 4 | **Restrict upload file access** — serve private evidence files through an authenticated endpoint that checks ownership; do not serve the uploads directory as public static files | C4 |

### High — Implement Before or Shortly After Launch

| # | Mitigation | Addresses |
|---|---|---|
| 5 | **Add CSRF protection** — use CSRF tokens or SameSite cookie attributes on all state-changing endpoints | H1 |
| 6 | **Add security headers** — implement CSP, X-Frame-Options (DENY), X-Content-Type-Options (nosniff), Referrer-Policy, Permissions-Policy via middleware (e.g. helmet) | H2 |
| 7 | **Validate uploaded file types** — check MIME type and magic bytes server-side; restrict to image formats (JPEG, PNG, GIF, WebP) | H3 |
| 8 | **Persist rate limiting** — use Redis or similar persistent store for rate limit counters | H5 |
| 9 | **Implement audit logging** — log authentication events, data modifications, file access, and administrative actions to a persistent log store | H6 |

### Medium — Implement as Part of Ongoing Compliance

| # | Mitigation | Addresses |
|---|---|---|
| 10 | **Randomise upload filenames** — use UUIDs instead of timestamp + original name | M1, L1 |
| 11 | **Strengthen password policy** — require 8+ characters; check against breached password lists (e.g. HaveIBeenPwned k-anonymity API) | M2 |
| 12 | **Force password set for legacy accounts** — require passwordless accounts to set a password on next login | M3 |
| 13 | **Sanitise error messages** — never expose raw error messages from third-party services to clients | M4 |
| 14 | **Execute DPAs** — establish data processing agreements with Stripe, SMTP/Resend, Railway, and any other processors | M5 |
| 15 | **Self-host fonts** — download and serve Cormorant Garamond and DM Sans locally to eliminate Google Fonts dependency | M6 |
| 16 | **Define and publish a retention policy** — set maximum retention periods; implement automated deletion of inactive accounts (e.g. 2 years) | Retention gap |
| 17 | **Implement DSAR process** — create a documented procedure and data export endpoint for subject access requests | Rights gaps |
| 18 | **Add profile editing** — allow users to update name, email, bio, location, portfolio via the platform | Art. 16 gap |

---

## 13. Summary

Officially Human Art collects a moderate amount of personal data necessary for its certification service. The core data protection risks are architectural — the absence of server-side authentication, encrypted storage, and HTTPS enforcement means that a motivated attacker could access or modify any user's data. These critical issues must be resolved before production launch.

The service does implement some good practices: bcrypt password hashing, rate limiting on authentication endpoints, XSS prevention via HTML encoding, email enumeration prevention, and a comprehensive account deletion flow. These provide a foundation to build upon.

Compliance with UK GDPR requires completing data processing agreements with third-party processors, implementing a formal DSAR process, defining a data retention policy, and publishing complete controller contact details in the privacy notice.

---

*This assessment should be reviewed and updated whenever significant changes are made to data processing activities, and at minimum annually.*
